<link rel="stylesheet" type="text/css" href="@Url.Content("~/fontEnd/css/style.css")" />
<div class="wrapperSectionHeading">
    <a class="sectionLink">
        <h2 class="sectionLinkH2">Danh Sách Playlist </h2>
    </a>

</div>
<div class="wrapperSectionBody_playlist">
    <div class="SectionItem">
        <div class="SectionItemImg-Artis_playlist">
            <img src="~/img/8640d841ca6413b752227781f6e9d8c3.jpg" alt="item" />
        </div>
        <div class="SectionItemIcon"></div>
        <div class="SectionItemTextArt">
            <h3 class="SectionItemTextName">Nguyễn Văn Kiên</h3>
            <div class="SectionItemTextDes">
                <a href="#" class="SectionItemTextDesLink">Artis</a>
            </div>
        </div>
    </div>
    <div class="SectionItem">
        <div class="SectionItemImg-Artis_playlist">
            <img src="~/img/8640d841ca6413b752227781f6e9d8c3.jpg" alt="item" />
        </div>
        <div class="SectionItemIcon"></div>
        <div class="SectionItemTextArt">
            <h3 class="SectionItemTextName">Nguyễn Văn Kiên</h3>
            <div class="SectionItemTextDes">
                <a href="#" class="SectionItemTextDesLink">Artis</a>
            </div>
        </div>
    </div>
    <div class="SectionItem">
        <div class="SectionItemImg-Artis_playlist">
            <img src="~/img/8640d841ca6413b752227781f6e9d8c3.jpg" alt="item" />
        </div>
        <div class="SectionItemIcon"></div>
        <div class="SectionItemTextArt">
            <h3 class="SectionItemTextName">Nguyễn Văn Kiên</h3>
            <div class="SectionItemTextDes">
                <a href="#" class="SectionItemTextDesLink">Artis</a>
            </div>
        </div>
    </div>
    <div class="SectionItem">
        <div class="SectionItemImg-Artis_playlist">
            <img src="~/img/8640d841ca6413b752227781f6e9d8c3.jpg" alt="item" />
        </div>
        <div class="SectionItemIcon"></div>
        <div class="SectionItemTextArt">
            <h3 class="SectionItemTextName">Nguyễn Văn Kiên</h3>
            <div class="SectionItemTextDes">
                <a href="#" class="SectionItemTextDesLink">Artis</a>
            </div>
        </div>
    </div>
    <div class="SectionItem">
        <div class="SectionItemImg-Artis_playlist">
            <img src="~/img/8640d841ca6413b752227781f6e9d8c3.jpg" alt="item" />
        </div>
        <div class="SectionItemIcon"></div>
        <div class="SectionItemTextArt">
            <h3 class="SectionItemTextName">Nguyễn Văn Kiên</h3>
            <div class="SectionItemTextDes">
                <a href="#" class="SectionItemTextDesLink">Artis</a>
            </div>
        </div>
    </div>
    <div class="SectionItem">
        <div class="SectionItemImg-Artis_playlist">
            <img src="~/img/8640d841ca6413b752227781f6e9d8c3.jpg" alt="item" />
        </div>
        <div class="SectionItemIcon"></div>
        <div class="SectionItemTextArt">
            <h3 class="SectionItemTextName">Nguyễn Văn Kiên</h3>
            <div class="SectionItemTextDes">
                <a href="#" class="SectionItemTextDesLink">Artis</a>
            </div>
        </div>
    </div>
    <div class="SectionItem">
        <div class="SectionItemImg-Artis_playlist">
            <img src="~/img/8640d841ca6413b752227781f6e9d8c3.jpg" alt="item" />
        </div>
        <div class="SectionItemIcon"></div>
        <div class="SectionItemTextArt">
            <h3 class="SectionItemTextName">Nguyễn Văn Kiên</h3>
            <div class="SectionItemTextDes">
                <a href="#" class="SectionItemTextDesLink">Artis</a>
            </div>
        </div>
    </div>
    <div class="SectionItem">
        <div class="SectionItemImg-Artis_playlist">
            <img src="~/img/8640d841ca6413b752227781f6e9d8c3.jpg" alt="item" />
        </div>
        <div class="SectionItemIcon"></div>
        <div class="SectionItemTextArt">
            <h3 class="SectionItemTextName">Nguyễn Văn Kiên</h3>
            <div class="SectionItemTextDes">
                <a href="#" class="SectionItemTextDesLink">Artis</a>
            </div>
        </div>
    </div>











</div>

<div class="add-playlist-btn">
    <button class="btn-add-playlist" onclick="openModal()">Thêm Playlist</button>
</div>

<!-- Modal -->
<div id="playlistModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <h3>Thêm Playlist Mới</h3>
        <form id="playlistForm">
            <label for="playlistName">Tên Playlist:</label>
            <input type="text" id="playlistName" name="playlistName" required />

          

            <button type="submit" class="btn-submit">Thêm</button>
        </form>
    </div>
</div>
<style>
    .modal {
        display: none; /* Ẩn mặc định */
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.5); /* Hiệu ứng nền mờ */
    }

    .modal-content {
        background-color: #fff;
        margin: 10% auto;
        padding: 20px;
        border-radius: 10px;
        width: 40%;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .close-btn {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
    }

        .close-btn:hover {
            color: #000;
        }

    .modal h3 {
        text-align: center;
        margin-bottom: 20px;
    }

    .modal label {
        display: block;
        margin: 10px 0 5px;
    }

    .modal input,
    .modal textarea {
        width: 100%;
        padding: 10px;
        margin-bottom: 15px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
    }

    .modal .btn-submit {
        display: block;
        background-color: #8d22c3;
        color: #fff;
        font-size: 16px;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        width: 100%;
        transition: background-color 0.3s ease;
    }

        .modal .btn-submit:hover {
            background-color: #7a1eaa;
        }


</style>


<script>

        $.ajax({
            url: '@Url.Action("getAllPlaylist", "Playlist")',
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                var $playlist_body = $('.wrapperSectionBody_playlist').eq(0);

                $playlist_body.empty();

                data.forEach(function (playlist) {


                    var playlistItem = `
                <div class="SectionItem">
                    <div class="SectionItemImg-Artis_playlist">
                        <img src="@Url.Content("~/img/vinyl.jpg")" alt="item" />
                    </div>
                    <div class="SectionItemIcon"></div>
                    <div class="SectionItemTextArt">
                        <h3 class="SectionItemTextName">${playlist.Name_Playlist}</h3>
                    </div>
                </div>
            `;


                    var $playlistItem = $(playlistItem);


                    $playlistItem.click(function (e) {
                        e.preventDefault();
                        $.ajax({
                            url: '@Url.Action("DetailPlaylist", "Playlist")',
                            type: 'GET',
                            data: { id_playlist: playlist.ID_Playlist },
                            success: function (response) {
                                $('#divBodyContent').html(response);
                                history.pushState(null, '', '/Playlist/' + playlist.Name_Playlist);
                            },
                            error: function () {
                                alert('Lỗi khi tải chi playlist.');
                            }
                        });
                    });

                    // Thêm item vào danh sách
                    $playlist_body.append($playlistItem);
                });
            },
            error: function (error) {
                alert("Lỗi load");
            }
        });




    function openModal() {
        document.getElementById("playlistModal").style.display = "block";
    }
    function closeModal() {
        document.getElementById("playlistModal").style.display = "none";
    }
    window.onclick = function (event) {
        const modal = document.getElementById("playlistModal");
        if (event.target === modal) {
            modal.style.display = "none";
        }
    };


    document.getElementById("playlistForm").onsubmit = function (e) {
        e.preventDefault();
        const playlistName = document.getElementById("playlistName").value;



        console.log("Tên Playlist:", playlistName);
        $.ajax({
        url: '@Url.Action("AddPlaylist", "Playlist")',
        type: 'GET',
        data: { PlaylistName: playlistName },
        success: function (response) {

            if (response.success) {
                alert(response.message);
                closeModal();

        $.ajax({
            url: '@Url.Action("getAllPlaylist", "Playlist")',
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                var $playlist_body = $('.wrapperSectionBody_playlist').eq(0);

                $playlist_body.empty();

                data.forEach(function (playlist) {


                    var playlistItem = `
                <div class="SectionItem">
                    <div class="SectionItemImg-Artis_playlist">
                        <img src="@Url.Content("~/img/vinyl.jpg")" alt="item" />
                    </div>
                    <div class="SectionItemIcon"></div>
                    <div class="SectionItemTextArt">
                        <h3 class="SectionItemTextName">${playlist.Name_Playlist}</h3>
                    </div>
                </div>
            `;


                    var $playlistItem = $(playlistItem);


                    $playlistItem.click(function (e) {
                        e.preventDefault();
                        $.ajax({
                            url: '@Url.Action("DetailPlaylist", "Playlist")',
                            type: 'GET',
                            data: { id_playlist: playlist.ID_Playlist },
                            success: function (response) {
                                $('#divBodyContent').html(response);
                              
                            },
                            error: function () {
                                alert('Lỗi khi tải chi playlist.');
                            }
                        });
                    });

                    // Thêm item vào danh sách
                    $playlist_body.append($playlistItem);
                });
            },
            error: function (error) {
                alert("Lỗi load");
            }
        });




            } else {
                alert(response.message);
            }
        },
        error: function (xhr, status, error) {
            // Xử lý lỗi
            alert("Có lỗi xảy ra: " + error);
        }
    });



    };






</script>